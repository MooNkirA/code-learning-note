# 并发编程-应用篇

## 1. 限制对 CPU 的使用

限制 CPU 高占用率。

### 1.1. sleep 实现

在没有利用 cpu 来计算时，让 `while(true)` 空转会浪费 cpu，这时可以使用 `yield` 或 `sleep` 来让出 cpu 的使用权给其他程序，从而减少cpu占用率

```java
while (true) {
    try {
        /*
         * 在没有利用 cpu 来计算时，让 while(true) 空转会浪费 cpu，
         * 这时可以使用 yield 或 sleep 来让出 cpu 的使用权给其他程序，
         * 从而减少cpu占用率
         */
        Thread.sleep(1);
    } catch (InterruptedException e) {
        e.printStackTrace();
    }
}
```

- 可以用 `wait` 或条件变量达到类似的效果
- 不同的是，后两种都需要加锁，并且需要相应的唤醒操作，一般适用于要进行同步的场景
- `sleep` 适用于无需锁同步的场景

### 1.2. wait 实现

```java
synchronized(锁对象) {
    while(条件不满足) {
        try {
            锁对象.wait();
        } catch(InterruptedException e) {
            e.printStackTrace();
        }
    }
    // do something...
}
```

### 1.3. 条件变量实现

```java
lock.lock();
try {
    while(条件不满足) {
        try {
            条件变量.await();
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
    }
    // do something...
} finally {
    lock.unlock();
}
```

## 2. 限制对共享资源的使用
