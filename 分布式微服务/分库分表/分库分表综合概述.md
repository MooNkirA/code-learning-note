## 1. 分库分表概述




## 2. 分库分表涉及技术

### 2.1. 分库分表解决方案

**ShardingSphere**是一套开源的分布式数据库中间件解决方案组成的生态圈，它由 Sharding-JDBC、Sharding-Proxy 和 Sharding-Sidecar（计划中）这3款相互独立的产品组成。它们均提供标准化的数据分片、分布式事务和数据库治理功能，可适用于 Java 同构、异构语言、容器、云原生等各种多样化的应用场景。其中 **Sharding-JDBC**是当当网研发的开源分布式数据库中间件。

> 官网地址：https://shardingsphere.apache.org/document/legacy/4.x/document/cn/manual/sharding-jdbc/

### 2.2. 分库分表后 id 主键解决方案

随着分库分表实现后，需要解决表生成一个全局唯一主键 id 的问题，以下生成全局 id 几种解决方案：

- **使用 UUID**：这种方式不适合作为主键，因为太长了，并且无序不可读，查询效率低。比较适合用于生成唯一的名字的标示比如文件的名字。
- **数据库自增 id**：两台数据库分别设置不同步长，生成不重复ID的策略来实现高可用。这种方式生成的 id 有序，但是需要独立部署数据库实例，成本高，还会有性能瓶颈。
- **利用 redis 生成 id**：性能比较好，灵活方便，不依赖于数据库。但是项目需要引入了新的组件，从而造成系统更加复杂，可用性降低，编码更加复杂，增加了系统成本。
- **Twitter 的 snowflake 算法**：
> snowflake 项目 Github 地址：https://github.com/twitter-archive/snowflake
- **美团的 Leaf 分布式 ID 生成系统**：Leaf 是美团开源的分布式ID生成器，能保证全局唯一性、趋势递增、单调递增、信息安全，里面也提到了几种分布式方案的对比，但也需要依赖关系数据库、Zookeeper等中间件。
> 参考美团技术团队的一篇文章：https://tech.meituan.com/2017/04/21/mt-leaf.html
